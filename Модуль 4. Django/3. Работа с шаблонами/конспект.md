# Конспект лекции по Django: Урок 3

## Введение

В этом уроке мы рассмотрим основные аспекты работы с шаблонами в Django. Мы создадим базовый шаблон, научимся использовать блоки и расширения, а также подключим статические файлы и создадим собственные шаблонные теги.

## Создание базового шаблона `base.html`

### Определение

**Шаблон** — это файл, который содержит HTML-код и специальные теги Django, которые позволяют динамически генерировать контент.

### Пример

1. **Создание базового шаблона**:
   - В корне проекта создаем папку `templates`.
   - Внутри этой папки создаем файл `base.html`.

2. **Настройка пути к шаблонам**:
   - В файле `settings.py` в разделе `TEMPLATES` указываем кастомный путь:
     ```python
     'DIRS': [BASE_DIR / 'templates'],
     ```

3. **Подключение базового шаблона**:
   - В файле `views.py` подключаем базовый шаблон для тестовой функции `main`.

### Аналогия

Базовый шаблон можно сравнить с каркасом дома. Он задает основную структуру, которую можно заполнить различными элементами (комнатами) в зависимости от потребностей.

## Синтаксис блоков в шаблонах: `{% block %}` и `{% extends %}`

### Определение

- **`{% block %}`**: Определяет блок контента, который может быть переопределен в дочерних шаблонах.
- **`{% extends %}`**: Указывает, что текущий шаблон расширяет базовый шаблон.

### Пример

1. **Описание блока `content`**:
   - В `base.html` описываем блок `content`:
     ```html
     {% block content %}
     {% endblock %}
     ```

2. **Создание и расширение шаблона `main.html`**:
   - Создаем файл `main.html` в папке `templates`.
   - В `main.html` используем `{% extends %}` для расширения `base.html`:
     ```html
     {% extends 'base.html' %}
     ```

3. **Переопределение блоков**:
   - В `main.html` переопределяем блоки `content` и `footer`:
     ```html
     {% block content %}
     <p>Это основной контент.</p>
     {% endblock %}

     {% block footer %}
     <p>Это футер.</p>
     {% endblock %}
     ```

### Аналогия

Блоки в шаблонах можно сравнить с секциями книги. Базовый шаблон — это обложка и основная структура книги, а блоки — это главы, которые можно заполнить различным содержимым.

## Создание шаблона `nav_menu.html` и подключение его в базовом шаблоне через `{% include %}`

### Определение

- **`{% include %}`**: Позволяет включить один шаблон в другой.

### Пример

1. **Создание каталога `includes`**:
   - В папке `templates` создаем каталог `includes`.

2. **Создание шаблона `nav_menu.html`**:
   - В папке `includes` создаем файл `nav_menu.html`.
   - В этом файле пишем навигационное меню.

3. **Использование тега `{% url %}`**:
   - В `nav_menu.html` используем тег `{% url %}` для создания ссылок:
     ```html
     <a href="{% url 'home' %}">Home</a>
     ```

4. **Подключение `nav_menu.html` в `base.html`**:
   - В `base.html` подключаем `nav_menu.html` через `{% include %}`:
     ```html
     {% include 'includes/nav_menu.html' %}
     ```

### Аналогия

Подключение шаблонов через `{% include %}` можно сравнить с модульной мебелью. Вы можете собрать различные элементы (шаблоны) в одну композицию (базовый шаблон).

## Начало работы над каталогом новостей

### Определение

**Динамическая вставка данных**: Процесс вставки данных в шаблон с использованием циклов и тегов `{% include %}`.

### Пример

1. **Создание шаблона `article_preview.html`**:
   - В папке `templates` приложения `news` создаем каталог `include`.
   - Внутри создаем файл `article_preview.html`.

2. **Динамическая вставка данных**:
   - Шаблон `article_preview.html` принимает словарь с данными о новости и возвращает новость, которая будет вставлена в каталог новостей в шаблоне `catalog.html` в цикле.

### Аналогия

Динамическая вставка данных можно сравнить с работой конвейера на заводе. Каждый элемент (новость) проходит через конвейер (цикл) и вставляется в нужное место (шаблон).

## Продолжение работы над каталогом статей

### Пример

1. **Создание шаблона `article_detail.html`**:
   - В папке `templates/news` создаем файл `article_detail.html`.

2. **Обновление функции `get_detail_article_by_id`**:
   - В функции `get_detail_article_by_id` делаем поиск статьи по ID в словаре и возвращаем шаблон `article_detail.html` или страницу `404`.

### Аналогия

Работа над каталогом статей можно сравнить с библиотекой. Каждая статья — это книга, которую можно найти по номеру (ID) и прочитать (отобразить детально).

## Собственные шаблонные теги через `simple_tag`

### Определение

**`simple_tag`**: Позволяет создавать собственные шаблонные теги для выполнения произвольных операций.

### Пример

1. **Создание тега `upper_words`**:
   - В файле `news/templatetags/upper_words.py` создаем тег `upper_words`:
     ```python
     from django import template

     register = template.Library()

     @register.simple_tag
     def upper_words(value):
         return value.upper()
     ```

2. **Тестирование тега**:
   - В шаблоне `article_detail.html` используем тег `upper_words`:
     ```html
     {% load upper_words %}
     <p>{% upper_words "пример текста" %}</p>
     ```

### Аналогия

Собственные шаблонные теги можно сравнить с инструментами в мастерской. Вы создаете специальный инструмент (тег), который выполняет конкретную задачу (операцию).

## Подключение статики в шаблоне `base.html`

### Определение

**Статика**: Статические файлы, такие как CSS, JavaScript и изображения, которые используются для стилизации и функциональности веб-страниц.

### Пример

1. **Создание папки `static`**:
   - В приложении `news` создаем папку `static`.
   - Внутри создаем папку `news`, а в ней папки `css` и `js`.

2. **Создание файлов `main.css` и `main.js`**:
   - В папке `css` создаем файл `main.css`.
   - В папке `js` создаем файл `main.js`.

3. **Подключение статики в `base.html`**:
   - В `base.html` подключаем статику через теги `{% load static %}` и `{% static %}`:
     ```html
     {% load static %}
     <link rel="stylesheet" type="text/css" href="{% static 'news/css/main.css' %}">
     <script src="{% static 'news/js/main.js' %}"></script>
     ```

### Аналогия

Подключение статики можно сравнить с декорированием комнаты. CSS и JavaScript — это элементы декора, которые добавляют стиль и функциональность.

## Работа с фильтрами в шаблонах

### Определение

**Фильтры**: Специальные функции, которые можно применять к переменным в шаблонах для изменения их представления.

### Пример

1. **Использование фильтров**:
   - В шаблоне `article_preview.html` используем фильтры `length`, `truncatechars` и `join`:
     ```html
     {{ article.title|length }}
     {{ article.content|truncatechars:50 }}
     {{ article.tags|join:", " }}
     ```

2. **Цикл для вывода тегов новости**:
   - В шаблоне `article_preview.html` добавляем цикл для вывода тегов новости:
     ```html
     {% for tag in article.tags %}
     <span>{{ tag }}</span>
     {% endfor %}
     ```

### Аналогия

Фильтры в шаблонах можно сравнить с инструментами для обработки текста. Они позволяют изменять и форматировать текст по вашему усмотрению.

## Заключение

В этом уроке мы рассмотрели основные аспекты работы с шаблонами в Django. Мы создали базовый шаблон, научились использовать блоки и расширения, а также подключили статические файлы и создали собственные шаблонные теги. Эти знания помогут вам создавать динамические и стильные веб-страницы.