# Урок 2: Динамические URL и перенаправления. Введение в шаблоны

## Введение
В этой лекции мы рассмотрим, как создавать динамические URL и использовать шаблоны в Django. Мы научимся передавать данные в шаблоны, использовать условия и циклы, а также организовывать маршруты в нашем проекте.

## Динамические URL в Django

### Что такое динамические URL?
Динамические URL — это URL, которые могут изменяться в зависимости от переданных параметров. В Django динамические URL создаются с помощью конвертеров, которые позволяют извлекать части URL и передавать их в представления (views).

### Примеры динамических URL
Пример динамического URL с конвертером `int`:
```python
path('news/<int:news_id>/', views.news_detail),
```
В этом примере `<int:news_id>` извлекает целое число из URL и передает его в представление `news_detail` как переменную `news_id`.

### Типы конвертеров
Django поддерживает несколько типов конвертеров:
- `<int:name>` — извлекает целое число.
- `<str:name>` — извлекает строку.
- `<slug:name>` — извлекает строку, состоящую из букв, цифр, дефисов и подчеркиваний.
- `<uuid:name>` — извлекает UUID.
- `<path:name>` — извлекает любую строку, включая слеши.

Пример использования конвертера `slug`:
```python
path('news/<slug:category>/', views.category_detail),
```

## Функция `include` в Django

### Что такое функция `include`?
Функция `include` позволяет включать маршруты из других файлов `urls.py` в основной файл маршрутов проекта. Это помогает организовать маршруты и сделать их более модульными.

### Пример использования `include`
Пример использования `include` в основном файле `urls.py` проекта:
```python
from django.contrib import admin
from django.urls import path, include

urlpatterns = [
    path('admin/', admin.site.urls),
    path('news/', include('news.urls')),
]
```
В этом примере маршруты из файла `urls.py` приложения `news` включаются в основной файл маршрутов проекта с префиксом `news/`.

## Что такое URL и его структура?
URL (Uniform Resource Locator) — это адрес ресурса в интернете. Он состоит из нескольких частей:
- Протокол (например, `http` или `https`)
- Доменное имя (например, `www.example.com`)
- Путь к ресурсу (например, `/news/catalog/`)
- Параметры запроса (например, `?param=value`)

Пример URL: `https://www.example.com/news/catalog/?param=value`

## Что такое конвертер?
Конвертер в URL — это способ извлечения части URL и преобразования её в переменную, которую можно использовать в представлении (view). В Django конвертеры позволяют извлекать части URL и передавать их в представления.

### Примеры и типы конверторов:
- `<int:news_id>` — извлекает целое число из URL и передает его в представление как переменную `news_id`.
- `<slug:slug>` — извлекает строку, состоящую из букв, цифр, дефисов и подчеркиваний, и передает её в представление как переменную `slug`.

Пример использования конвертера:
```python
path('news/<int:news_id>/', views.news_detail),
```

## Что такое DTL и какие теги в нём бывают?
DTL (Django Template Language) — это язык шаблонов, используемый в Django для динамического генерирования HTML-контента. DTL позволяет вставлять переменные, использовать условия, циклы и фильтры для форматирования данных.

### Основные теги DTL:
- `{{ variable }}` — вставка значения переменной.
- `{% if condition %} ... {% endif %}` — условное выполнение кода.
- `{% for item in list %} ... {% endfor %}` — цикл для итерации по списку.
- `{% block name %} ... {% endblock %}` — блок, который можно переопределить в дочерних шаблонах.
- `{% extends "base.html" %}` — наследование шаблона.
- `{% include "template.html" %}` — включение другого шаблона.
- `{% url 'name' arg1 arg2 %}` — генерация URL по имени маршрута.
- `{% csrf_token %}` — вставка CSRF-токена для защиты форм.
- `{% comment %} ... {% endcomment %}` — комментарий, который не будет отображаться в выходном HTML.

## Что такое шаблоны в Django и для чего они нужны?
Шаблоны в Django используются для отделения логики представления данных от их отображения. Это позволяет разработчикам создавать динамические веб-страницы, которые могут изменяться в зависимости от данных, переданных из представлений. Шаблоны помогают поддерживать чистый и организованный код, разделяя его на логику и представление.

## Что такое функция `render` и как она работает?
Функция `render()` в Django используется для объединения данных с шаблоном и возвращения HTTP-ответа. Она принимает запрос (request), имя шаблона и контекст (словарь данных), которые будут переданы в шаблон.

Пример использования `render()`:
```python
from django.shortcuts import render

def my_view(request):
    context = {'key': 'value'}
    return render(request, 'my_template.html', context)
```

## Как передаются данные в шаблон?
Данные передаются в шаблон в виде словаря, который называется контекстом (context). Этот словарь содержит пары "ключ-значение", где ключи — это имена переменных, которые будут доступны в шаблоне, а значения — это данные, которые вы хотите передать.

Пример передачи данных в шаблон:
```python
context = {
    'title': 'My Page Title',
    'items': ['Item 1', 'Item 2', 'Item 3']
}
return render(request, 'my_template.html', context)
```

## Что такое `context`?
Параметр `context` в функции `render()` — это словарь, который содержит данные, которые вы хотите передать в шаблон. Ключи этого словаря становятся переменными, доступными в шаблоне, а значения — это данные, которые будут использованы в шаблоне.

## Как распаковываются данные в шаблоне?
В шаблоне вы можете распаковать данные, используя двойные фигурные скобки `{{ }}`. Это позволяет вам вставлять значения переменных, переданных в контексте, в HTML-код.

Пример распаковки данных в шаблоне:
```html
<!DOCTYPE html>
<html>
<head>
    <title>{{ title }}</title>
</head>
<body>
    <ul>
        {% for item in items %}
            <li>{{ item }}</li>
        {% endfor %}
    </ul>
</body>
</html>
```

## Как написать условие в шаблоне? Для чего это нужно?
Условия в шаблоне пишутся с использованием тегов `{% if %}`, `{% elif %}`, `{% else %}`, и `{% endif %}`. Это позволяет вам управлять отображением контента в зависимости от значений переменных.

Пример использования условия в шаблоне:
```html
{% if user.is_authenticated %}
    <p>Welcome, {{ user.username }}!</p>
{% else %}
    <p>Please log in.</p>
{% endif %}
```

Условия нужны для того, чтобы динамически изменять содержимое страницы в зависимости от различных условий, таких как состояние пользователя, наличие данных и т.д.

## Как написать цикл в шаблоне? Для чего это нужно?
Циклы в шаблоне пишутся с использованием тегов `{% for %}` и `{% endfor %}`. Это позволяет вам проходить по элементам списка или другой итерируемой структуры и отображать их в шаблоне.

Пример использования цикла в шаблоне:
```html
<ul>
    {% for item in items %}
        <li>{{ item }}</li>
    {% endfor %}
</ul>
```

Циклы нужны для того, чтобы динамически генерировать повторяющиеся элементы на странице, такие как списки, таблицы и т.д., на основе данных, переданных в контексте.
